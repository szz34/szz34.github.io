---
title: '【论文阅读笔记】Walkway Discovery from Large Scale Crowdsensing'
date: 2021-10-29
permalink: /posts/2021/10/vitalalley/
tags:
  - walkway discovery
  - mobility trajectory
  - crowdsensing
---

[原文链接](https://ieeexplore.ieee.org/document/8480032)

# Background
如今，各类地图软件app已经成为人们日常出行导航不可或缺的工具。然而，现存软件大都对地图包含不完整，例如一些捷径、小路等，我们在生活中经常通过它们来节省通勤时间，但软件却没有涵盖这些路径。本文就是探究如何利用群智感知（Crowdsensing）发现这些路径，并把它们集成到现有地图软件中，方便人们日常出行。

# Related Work
COBWEB: a robust map update system using GPS trajectories. 

Crowdatlas: Self-updating maps for cloud and personal use. 

在发现新路径这一领域有许多相关研究工作，但他们主要针对的都是道路结构标准、车辆行驶方向统一的高速公路，而针对结构不规则、行人行走方向高度随机的人行道的研究却少之又少。且以往用于高速公路的算法也不能直接应用到搜索人行道上。

![image](https://github.com/user-attachments/assets/11faabe4-4b17-4536-a890-b5820851ad63)

如上图所示，高速公路（黑色实线）往往很笔直，车辆在上面遵循相同的方向行驶；人行道（黑色虚线）就显得比较曲折，且行人可以向各个方向行走。

# System design
基于以上问题，本文提出的解决方案是VitalAlley系统。它先利用数据集中的信息估算出一个大致的可行走区域，之后在该区域中提取具有代表性的人行道，最后通过引入谷歌街景的数据自动验证该人行道是否真实存在。下图为系统架构图。

![image](https://github.com/user-attachments/assets/80244175-eb3b-4692-b641-1bdb648574f4)

# Dataset
我们先来看一下系统所采用的数据集。本文使用的是来自新加坡国家科学实验（NES）的数据，数据记录了当地十万多名学生长达11周的位置移动信息，总计轨迹长度可达数十亿公里。该实验通过学生佩戴的传感器装置来采集信息并上传，数据一共包含十几个属性。我们的系统将主要利用学生的位置、累计步数以及出行方式（步行、乘车等）这三个属性。由于学生对当地的道路情况非常熟悉，且经常选择走一些未知的小路来节约时间，所以这些数据可以有效的帮助我们找到地图软件中没有涵盖到的人行道。

# Data preprocessing
由于学生佩戴的设备存在定位误差，以及学生移动特点（主要待在家或学校内）的影响，并非所有数据都对我们的研究有帮助，因此我们需要对数据进行预处理：

（1）根据数据中的“出行方式”这一属性，只保留步行状态的数据。

（2）删除了噪声数据（图中正方形点），也就是定位误差较大，远离学生移动轨迹的点。

（3）由于学生的活动位置主要集中在家和学校，这些数据对我们发现人行道同样没有帮助，因此删除此类逗留数据（红色虚线圈出）。

（4）对剩余数据进行分类，将那些与地图软件中已存在的道路高度匹配的点称为“匹配点”（圆圈代表的点），反之不能与任何道路匹配的点称为“不匹配点”（三角代表的点），此类点大概率代表了未知的人行道。我们后续的工作将主要利用匹配和不匹配这两种数据。

![image](https://github.com/user-attachments/assets/88a13589-750a-4193-92d6-87101e683bfe)

# Walkable Area Estimation
下面主要探究功能模块的实现方法。首先我们基于处理后的位置数据和步数数据对潜在的可行走区域进行估计。我们构建了一种椭圆模型来模拟可行走区域。众所周知要确定一个椭圆，需要确定两个焦点的位置，以及椭圆上一点到两个焦点的距离之和。我们将连续两条数据（学生佩戴的设备每个15秒记录一条信息）的位置信息设为椭圆的两个焦点，而距离之和为两个位置间的步数与步长的乘积（此处不知道是论文表述问题还是我的理解问题，距离之和本应为椭圆长轴的长度，而按论文的计算方法为焦距的长度），我们根据一项研究报告将步长设为0.78米（学生平均步长）。这样我们就得到了两个位置所在的大致可行走区域。

![image](https://github.com/user-attachments/assets/cdc6daf3-3e84-4a00-89f2-d941eddec90d)

可见步数信息对于我们建立椭圆模型十分重要，但现实情况是：学生佩戴的设备对步数的记录并不准确。为了节省计算成本，步数信息的更新周期比位置信息的更新周期更长，如下图所示，很多时候学生的位置（黑色虚线）已经发生了变化，但步数（蓝线）没有更新。

![image](https://github.com/user-attachments/assets/6b6dfb96-7f7f-4560-b56c-9f1ce7183649)

为了解决这一问题，我们通过线性回归分析步数和距离之间的关系，发现两个连续位置之间的距离与步数线性相关，如下图所示。基于这个结论，我们可以通过为每个学生训练一个线性回归模型来发现其步数和移动距离之间的关系，之后我们只需要利用位置信息就可以得到步数信息，进而构建相应的椭圆模型。

![image](https://github.com/user-attachments/assets/90a6ae08-e49e-4ac7-803f-bf17224d001e)

下面我们对上述得到的可行走区域做进一步优化，使用一种加权方案来得到区域中各个位置被行人经过的概率。我们首先将区域划分为一个个的小格子，每个格子大小为2乘2，之后对于每两条连续数据形成的椭圆，我们基于二元高斯模型（该部分较为复杂，论文也未完全展开详述，感兴趣可搜索相关资料了解模型原理）计算该椭圆中的格子被经过的概率。对所有椭圆计算完成之后，若一个格子被越多的椭圆所覆盖，则该格子对应位置被行人经过的概率就越大。最终我们可以得到下面图b这样的一张得分图，颜色越深的位置代表概率越大。

![image](https://github.com/user-attachments/assets/8015c1fd-4413-4f07-8d37-d4dab348a9f9)

# Representative Walkway Identification
我们这项研究工作的最终目的是发现一条能够加载进地图软件的代表性路线，而并非一整片非常精确的可行走区域，一来我们没有足够的数据量做支撑，二来不容易直接集成到现有的电子地图中。因此在本模块中，我们将通过两个阶段，从可行走区域中提取代表性路线。

第一阶段，我们将基于位置聚类识别交叉点。所谓交叉点，就是可行走区域与地图软件中已存路段相连接的位置，这些位置通常对应可行走区域的入口或出口。最后匹配点是指那些与已知路段位置高度匹配，且其上一个位置或下一个位置处在未知区域中的点。如下图中的A1，A2，B1，B2。

![image](https://github.com/user-attachments/assets/94223d46-af82-4ed5-9aa8-a31ae39c65c2)

我们收集所有学生的数据，将与同一条已存路段匹配的这类点划为一组。之后在每组点中利用HDBSCAN算法将点划分为多个簇，如下图中的SC1，SC2，SC3，每个簇便对应一个潜在的交叉点。最后我们计算每个簇中与其他点总距离最短的点的位置，即为交叉点的位置。

![image](https://github.com/user-attachments/assets/7c093bb3-d399-49aa-ad86-0306703a0032)

第二阶段，我们将基于轨迹聚类提取代表性路线。通过上一阶段我们获得了连接已存路段和可行走区域的交叉点，而轨迹则为连接两个交叉点，即可行走区域的入口和出口之间的一条路线。我们首先根据该轨迹两端的点为每条轨迹命名，如上图，两端连接的分别为SC-1簇和SC-2簇，于是将路线命名为<SC-1, SC-2>。我们发现即使同样的一对入口和出口，中间也可能存在多条可走的轨迹，例如从SC-1到SC-2，存在三角到三角、圆到圆、菱形到菱形这三条轨迹，它们可能对应着多条代表性路线。于是下一步，我们将命名相同的多条轨迹划分为一组，并在每一组中利用聚类算法（具体算法见论文中提到的参考文献）划分为一个或多个簇，每个簇对应一条代表性路线，簇中包含的轨迹数为该代表性路线的支持度。如上图中的两条代表性路线，它们的支持度分别为3和1。

在现实生活中的一条路应该是位于可行走区域中的一条多段线（也就是比较曲折），这条线将穿过那些分数较高的格子。而我们当前只得到一条大概形状的路线，因此还要对其进行优化。我们的做法是，将原本的由许多小格子组成的地图转化为简单的仅包含点和边的图，其中点代表原图中的格子，两个连续位置之间用边连接。我们还将原图中格子对应的概率得分的倒数设置为点的权值。在构建好带权图之后，我们可以利用A*算法（使用其他类似算法也可以）得到最优路径，也就是所含点的总权值最小的路径，这就是我们最终的代表性路线。

![image](https://github.com/user-attachments/assets/14a2f06e-8e68-4096-b09a-6a0c70f94d10)

![image](https://github.com/user-attachments/assets/95ae89be-ef32-4ae4-a674-5c1935f6e9b9)

# Auto-Verification
在获得代表性路线，也就是人行道之后，我们需要验证该人行道在现实中是否真实存在。为了能够实现自动验证功能，我们引入了谷歌街景接口（GSV），它为我们提供了丰富的街景照片，可以帮助我们检索人行道与已知路段交叉点处的图像，进而证明人行道的存在。我们的做法是获取人行道交叉点的位置信息，并在GSV中检索相应位置的图像。为了保证检索的成功率，如图所示，我们以交叉点为原点，生成两条射线，夹角的大小要求可以包含所有构成该交叉点的位置点，然后每隔30度获取一张图像。如下图就是在眼睛的位置检索到的一张图像，可以清晰的看到在草坪中存在一条人行道。

![image](https://github.com/user-attachments/assets/32262aed-ec50-45d3-8eab-8dda56615f03)

在检索到相应图像后，我们对图像进行一系列处理，并与模板图像做比对，验证人行道是否真实存在：

（1）首先基于像素值将图像分割为多个簇，之后直接舍弃掉图像的上半部分。因为大部分道路都出现在图像下方，这样可以减少计算成本。

（2）提取图像的关键点，这些点大多出现在分割线的周围，进而计算这些关键点的梯度大小和方向，并以直方图的形式表示。如下图中的直方图，横轴代表梯度方向，纵轴代表梯度大小。最后将此图像与模板图像做比对，这里的模板图像具体指什么我们后面再解释。模板图像也有一个相应的直方图。我们计算两直方图的卡方距离，若差距小于某个阈值，则可以认为该图像满足典型交叉点的特征，即对应的人行道真实存在。

![image](https://github.com/user-attachments/assets/be68d0fc-3782-4047-97b2-2e11f285f67c)

![image](https://github.com/user-attachments/assets/1f8a400c-9fb9-4da7-b62c-7a670a7ee571)

下面我来解释一下模板图像的来源和内容。谷歌街景为我们提供了丰富的人行道图像，由于考虑到人行道往往类型有限且特征明显，因此我们完全可以提前构建一个模板图像库，方便实现我们的自动验证功能。构建库的方法也很直接，我们在GSV中收集人行道入口或出口处的图像，并按照我们上一步中处理图像的方式，为每张图像求出其相应的直方图。这样，每当要验证一张图像时，只需将此图像的直方图与模板库中图像的直方图做比对，只要存在一张模板图像与现有图像比对成功，就可以认为当前人行道真实存在。模板库的存在极大的方便了自动验证过程，我们也将不断丰富模板库的内容，以提高比对准确率。至此，VitalAlley的系统架构全部介绍完毕。

![image](https://github.com/user-attachments/assets/58c8d1f7-5108-4f96-a186-f9226ec8d475)

# Performance Evaluation
下面对VitalAlley系统做性能评估。此处直接简单说明结论，详细请见原文，图表表达的很清楚。

我们使用VitalAlley在新加坡发现了736条新的人行道，总里程可达150多公里。我们通过实地考察的方式证明真实存在的人行道比例可达93%。

![image](https://github.com/user-attachments/assets/6af1f7f1-2145-4a49-baa8-ec2f127a24ee)

# Conclusion
最后做个总结。本文希望发现并验证一些地图软件中不包含的人行道，并借此完善这些地图软件，方便行人的日常出行。为此本文提出了VitalAlley系统架构，它通过估计可行走区域，在区域中提取代表性路线来发现潜在的人行道，并自动验证该人行道是否真实存在。我们最后对系统进行评估，在新加坡发现了736条新的人行道，并通过实地验证的方式证明该系统的准确率可达到93%以上。

# 阅读感受
本文对其要做的事情表达的很清楚，即发现一些潜在的小路，供行人方便出行。整个系统的逻辑架构也比较清晰。但是对于每个功能的具体实现方式没有展开详述，需要读者进一步查阅参考文献，采用的一些算法、模型等，如二元高斯模型、A*、HDBSCAN算法等，对于之前没有了解过的读者，可能要花很多时间去了解算法原理。

------
